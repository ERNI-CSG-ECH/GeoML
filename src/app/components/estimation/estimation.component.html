<mat-card class="estimation">
  <div *ngIf="tasks$ | async as tasks" class="estimation__progress">
    <span *ngFor="let task of tasks; let idx = index" class="estimation__progress-step"
      [ngClass]="{'active': idx <= try}"></span>
  </div>
  <mat-card-title class="estimation__title">
    <ng-container *ngIf="correctValue === undefined" i18n>Wie hoch sch채tzen sie das Risiko?</ng-container>
    <ng-container *ngIf="correctValue !== undefined && correctValue === selectedValue" i18n>Ihre Einsch채tzung war
      richtig</ng-container>
    <ng-container *ngIf="correctValue !== undefined && correctValue !== selectedValue" i18n>Die richtige Einsch채tzung
      w채re Stufe {{ correctValue }}</ng-container>
  </mat-card-title>
  <mat-card-content *ngIf="tasks$ | async as tasks" class="estimation__content">
    <img #estimationImage class="estimation__content-image"
      src="{{ apiEndpoint }}/files/{{ tasks[try] }}_{{ checked ? 'result' : 'initial' }}.png" />
    <mat-divider class="estimation__divider"></mat-divider>
    <div class="estimation__values">
      <div class="estimation__values-button-container" *ngFor="let task of tasks; let idx = index">
        <button mat-fab class="estimation__values-button" [ngClass]="{
          'estimation__values-selected': idx + 1 === selectedValue && correctValue === undefined,
          'estimation__values-solution': correctValue !== undefined,
          'estimation__values-solution-false':
            correctValue !== selectedValue && idx + 1 === selectedValue && correctValue !== undefined,
          'estimation__values-solution-correct':
            correctValue === selectedValue && idx + 1 === selectedValue && correctValue !== undefined,
          'estimation__values-solution-true':
            correctValue !== selectedValue && idx + 1 === correctValue && correctValue !== undefined
        }" (click)="selectedValue = idx + 1">
          {{ idx + 1 }}
        </button>
        <span *ngIf="correctValue!==undefined&&idx + 1===botValue" class="estimation__values-button-badge">
          <svg-icon name="bot"></svg-icon>
        </span>
      </div>
    </div>
    <div class="estimation__result">
      <ng-container *ngIf="score !== undefined">
        <div i18n>Ihre Punktzahl: {{ score.human }}</div>
        <div i18n>Punkte Algorithmus: {{ score.bot }}</div>
      </ng-container>
    </div>
    <mat-divider class="estimation__divider"></mat-divider>
  </mat-card-content>
  <mat-card-actions class="estimation__actions">
    <button mat-raised-button i18n class="estimation__actions-next" [disabled]="selectedValue === undefined"
      (click)="correctValue === undefined ? check() : next()">
      <ng-container *ngIf="correctValue === undefined">{{ checkText }}</ng-container>
      <ng-container *ngIf="correctValue !== undefined && try < 4">{{ nextText }}</ng-container>
      <ng-container *ngIf="correctValue !== undefined && try === 4">{{ resultText }}</ng-container>
    </button>
  </mat-card-actions>
</mat-card>
